<div class="modal-backdrop" *ngIf="open" (click)="onBackdropClick($event)">
  <div class="modal" role="dialog" aria-modal="true" (click)="$event.stopPropagation()">
    <header class="modal-header">
      <h3 class="title">{{ product?.name }}</h3>
      <button class="close-btn" (click)="closed.emit()" aria-label="Fechar">
        ✕
      </button>
    </header>

    <section class="modal-content">
      <div class="media">
        <img [src]="product?.image" [alt]="product?.name">
      </div>
      <div class="details">
        <div class="price-block" *ngIf="product?.price as p">
          <div class="price">{{ p | currency:'BRL' }}</div>
          <div class="original" *ngIf="product?.originalPrice as op">{{ op | currency:'BRL' }}</div>
        </div>

        <div class="meta">
          <span class="badge" *ngFor="let b of product?.badges">{{ b }}</span>
          <span class="category">{{ product?.category }}</span>
        </div>

        <div class="stock-info" *ngIf="product">
          <span class="stock-label" [ngClass]="{'out-of-stock': product.stockQuantity === 0, 'low-stock': product.stockQuantity > 0 && product.stockQuantity <= 5}">
            <ng-container *ngIf="product.stockQuantity === 0">❌ ESGOTADO</ng-container>
            <ng-container *ngIf="product.stockQuantity > 0">✓ {{ product.stockQuantity }} unidades disponíveis</ng-container>
          </span>
        </div>

        <p class="description" *ngIf="product?.description">{{ product?.description }}</p>
      </div>
    </section>

    <footer class="modal-footer">
      <button class="ghost">Testar no Visualizador 3D</button>
      <button class="primary" (click)="onAddToCart()" [disabled]="product?.stockQuantity === 0">
        <ng-container *ngIf="product?.stockQuantity === 0">Produto Esgotado</ng-container>
        <ng-container *ngIf="product && product.stockQuantity > 0">Adicionar ao Carrinho</ng-container>
      </button>
    </footer>
  </div>
</div>
